<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>员工系统 - 货物登记</title>
    <style>
               .history-section {
            margin-top: 40px;
            border-top: 2px solid #4CAF50;
            padding-top: 20px;
        }
        
        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .history-list {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        
        .history-item {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .history-item:hover {
            background-color: #f5f5f5;
        }
        
        .history-item.active {
            background-color: #e3f2fd;
            border-left: 4px solid #2196F3;
        }
        
        .history-date {
            font-weight: bold;
            color: #2c3e50;
        }
        
        .history-preview {
            display: flex;
            margin-top: 8px;
            font-size: 13px;
            color: #666;
        }
        
        .history-preview span {
            margin-right: 15px;
        }
        
        .history-actions {
            margin-top: 15px;
            text-align: right;
        }
        
        /* 查看面板 */
        .view-panel {
            display: none;
            margin-top: 30px;
            padding: 20px;
            background-color: #f9f9f9;
            border-radius: 5px;
            border: 1px solid #ddd;
        }
        
        .view-panel h3 {
            margin-top: 0;
            color: #4CAF50;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        
        .close-panel {
            float: right;
            background: #f44336;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
        }
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            border-radius: 5px;
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        .date-section {
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .date-section label {
            margin-right: 10px;
            font-weight: bold;
        }
        input[type="date"] {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        .category-title {
            background-color: #4CAF50;
            color: white;
            padding: 8px 15px;
            margin: 25px 0 10px;
            border-radius: 4px;
            font-size: 18px;
        }
        .goods-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
        }
        .goods-table th {
            background-color: #e0e0e0;
            padding: 12px 8px;
            text-align: left;
            font-weight: normal;
            border: 1px solid #ddd;
        }
        .goods-table td {
            padding: 10px 8px;
            border: 1px solid #ddd;
            vertical-align: top;
        }
        .goods-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .goods-table tr:hover {
            background-color: #f1f1f1;
        }
        .input-small {
            width: 60px;
            padding: 5px;
            text-align: center;
            border: 1px solid #ccc;
            border-radius: 3px;
        }
        .action-buttons {
            text-align: center;
            margin-top: 30px;
        }
        .btn {
            padding: 10px 25px;
            margin: 0 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
        }
        .btn-submit {
            background-color: #4CAF50;
            color: white;
        }
        .btn-submit:hover {
            background-color: #45a049;
        }
        .btn-reset {
            background-color: #f44336;
            color: white;
        }
        .btn-reset:hover {
            background-color: #d32f2f;
        }
        .logout-btn {
            display: block;
            width: 120px;
            margin: 40px auto 0;
            padding: 10px;
            background-color: #3498db;
            color: white;
            text-align: center;
            text-decoration: none;
            border-radius: 4px;
            transition: background-color 0.3s;
        }
        .logout-btn:hover {
            background-color: #2980b9;
        }
        .code-cell {
            font-family: 'Courier New', monospace;
            color: #2c3e50;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>货物库存管理系统</h1>
        
        <div class="date-section">
            <label>当前日期:</label>
            <input type="date" id="workDate" name="workDate">
        </div>
        
        
        <!-- 汤底类 -->
        <div class="category-title">汤底 | SOUP BASE</div>
        <table class="goods-table">
            <thead>
                <tr>
                    <th width="8%">编号</th>
                    <th width="15%">中文名称</th>
                    <th width="15%">英文名称</th>
                    <th width="15%">规格</th>
                    <th width="8%">单位</th>
                    <th width="8%">库存</th>
                    <th width="8%">入库</th>
                    <th width="8%">出库</th>
                    <th width="15%">备注</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="code-cell">SB-002</td>
                    <td>凉椰肉</td>
                    <td>COCONUT MEAT</td>
                    <td>1 PKT X 1 KG</td>
                    <td>KG (100)</td>
                    <td><input type="number" class="input-small" value="0"></td>
                    <td><input type="number" class="input-small" value="0"></td>
                    <td><input type="number" class="input-small" value="0"></td>
                    <td><input type="text" style="width:100%"></td>
                </tr>
                <tr>
                    <td class="code-cell">SB-003</td>
                    <td>椰汁(支装)</td>
                    <td>COCONUT WATER (BOTTLE)</td>
                    <td>1 BTL X 1000 ML</td>
                    <td>BTL</td>
                    <td><input type="number" class="input-small" value="0"></td>
                    <td><input type="number" class="input-small" value="0"></td>
                    <td><input type="number" class="input-small" value="0"></td>
                    <td><input type="text" style="width:100%"></td>
                </tr>
                <tr>
                    <td class="code-cell">SB-012</td>
                    <td>麻辣汤膏</td>
                    <td>CHEF YONG - MALA PASTE</td>
                    <td>1 TUB X 5KG</td>
                    <td>TUB</td>
                    <td><input type="number" class="input-small" value="0"></td>
                    <td><input type="number" class="input-small" value="0"></td>
                    <td><input type="number" class="input-small" value="0"></td>
                    <td><input type="text" style="width:100%"></td>
                </tr>
                <tr>
                    <td class="code-cell">SB-004</td>
                    <td>骨汤膏</td>
                    <td>HDL - BONE SOUP BASE 2</td>
                    <td>1 CTN X 10 PKT</td>
                    <td>PKT</td>
                    <td><input type="number" class="input-small" value="0"></td>
                    <td><input type="number" class="input-small" value="0"></td>
                    <td><input type="number" class="input-small" value="0"></td>
                    <td><input type="text" style="width:100%"></td>
                </tr>
                <tr>
                    <td class="code-cell">SB-005</td>
                    <td>麻辣汤油</td>
                    <td>HDL - BUTTER & SPICY</td>
                    <td>1 CTN X 16 PKT</td>
                    <td>PKT</td>
                    <td><input type="number" class="input-small" value="0"></td>
                    <td><input type="number" class="input-small" value="0"></td>
                    <td><input type="number" class="input-small" value="0"></td>
                    <td><input type="text" style="width:100%"></td>
                </tr>
                <tr>
                    <td class="code-cell">SB-006</td>
                    <td>养生汤膏</td>
                    <td>HDL - CLEAR SOUP</td>
                    <td>1 CTN X 10 PKT</td>
                    <td>PKT</td>
                    <td><input type="number" class="input-small" value="0"></td>
                    <td><input type="number" class="input-small" value="0"></td>
                    <td><input type="number" class="input-small" value="0"></td>
                    <td><input type="text" style="width:100%"></td>
                </tr>
                <!-- 更多汤底类产品... -->
            </tbody>
        </table>
        
        <!-- 面类 -->
        <div class="category-title">面类 | NOODLE</div>
        <table class="goods-table">
            <thead>
                <tr>
                    <th width="8%">编号</th>
                    <th width="15%">中文名称</th>
                    <th width="15%">英文名称</th>
                    <th width="15%">规格</th>
                    <th width="8%">单位</th>
                    <th width="8%">库存</th>
                    <th width="8%">入库</th>
                    <th width="8%">出库</th>
                    <th width="15%">备注</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="code-cell">ND-001</td>
                    <td>萝卜面</td>
                    <td>CARROT NOODLE</td>
                    <td>1 CTN X 24 PCS</td>
                    <td>PCS</td>
                    <td><input type="number" class="input-small" value="0"></td>
                    <td><input type="number" class="input-small" value="0"></td>
                    <td><input type="number" class="input-small" value="0"></td>
                    <td><input type="text" style="width:100%"></td>
                </tr>
                <tr>
                     <td class="code-cell" rowspan="2">ND-002</td>
                     <td rowspan="2">冬粉</td>
                     <td rowspan="2">GLASS NOODLE</td>
                     <td>1 PKT X 10 PCS</td>
                     <td>PKT</td>
                     <td><input type="number" class="input-small" value="0"></td>
                     <td><input type="number" class="input-small" value="0"></td>
                     <td><input type="number" class="input-small" value="0"></td>
                     <td rowspan="2"><input type="text" style="width:100%"></td>
                </tr>
                <tr class="sub-row">
                     <td>1 SET X 6 PKT</td>
                     <td>SET</td>
                     <td><input type="number" class="input-small" value="0"></td>
                     <td><input type="number" class="input-small" value="0"></td>
                     <td><input type="number" class="input-small" value="0"></td>
                </tr>
                <tr>
                    <td class="code-cell">ND-004</td>
                    <td>手工乌冬面</td>
                    <td>HANDMADE UDON</td>
                    <td>1 PKT X 4 PCS</td>
                    <td>PCS</td>
                    <td><input type="number" class="input-small" value="0"></td>
                    <td><input type="number" class="input-small" value="0"></td>
                    <td><input type="number" class="input-small" value="0"></td>
                    <td><input type="text" style="width:100%"></td>
                </tr>
                <tr>
                    <td class="code-cell">ND-005</td>
                    <td>迷你伊丽</td>
                    <td>MINISHARU NOODLE</td>
                    <td>1 PKT X 10 PCS</td>
                    <td>PKT</td>
                    <td><input type="number" class="input-small" value="0"></td>
                    <td><input type="number" class="input-small" value="0"></td>
                    <td><input type="number" class="input-small" value="0"></td>
                    <td><input type="text" style="width:100%"></td>
                </tr>
                <!-- 更多面类产品... -->
            </tbody>
        </table>
        
         <div class="action-buttons">
            <button class="btn btn-submit" id="submitBtn">提交数据</button>
            <button class="btn btn-reset">重置表单</button>
        </div>
        
        <!-- 新增历史记录区域 -->
        <div class="history-section">
            <div class="history-header">
                <h2>历史记录</h2>
                <div>
                    <button id="refreshHistory" class="btn">刷新列表</button>
                    <button id="clearHistory" class="btn btn-reset">清除所有</button>
                </div>
            </div>
            
            <div class="history-list" id="historyList">
                <!-- 动态加载历史记录 -->
            </div>
            
            <!-- 历史记录查看面板 -->
            <div class="view-panel" id="viewPanel">
                <button class="close-panel" id="closePanel">关闭</button>
                <h3 id="viewTitle">记录详情</h3>
                <div id="viewContent"></div>
            </div>
        </div>

    <script>
        // 设置默认日期为今天
        document.getElementById('workDate').valueAsDate = new Date();
        
        // 提交按钮点击事件
        document.getElementById('submitBtn').addEventListener('click', saveData);
        
        // 刷新历史记录
        document.getElementById('refreshHistory').addEventListener('click', loadHistory);
        
        // 清除历史记录
        document.getElementById('clearHistory').addEventListener('click', function() {
            if (confirm('确定要清除所有历史记录吗？此操作不可恢复！')) {
                localStorage.removeItem('allInventoryReports');
                loadHistory();
                alert('已清除所有记录！');
            }
        });
        
        // 关闭查看面板
        document.getElementById('closePanel').addEventListener('click', function() {
            document.getElementById('viewPanel').style.display = 'none';
        });
        
        // 保存数据
        function saveData() {
            const selectedDate = document.getElementById('workDate').value;
            const reportData = {
                date: selectedDate,
                soupBase: [],
                noodle: []
            };
            
            // 收集汤底类数据
            document.querySelectorAll('.goods-table:first-of-type tbody tr').forEach(row => {
                reportData.soupBase.push({
                    code: row.cells[0].textContent,
                    nameCN: row.cells[1].textContent,
                    nameEN: row.cells[2].textContent,
                    spec: row.cells[3].textContent,
                    unit: row.cells[4].textContent,
                    stock: row.cells[5].querySelector('input').value,
                    in: row.cells[6].querySelector('input').value,
                    out: row.cells[7].querySelector('input').value,
                    remark: row.cells[8].querySelector('input').value
                });
            });
            
            // 收集面类数据
            document.querySelectorAll('.goods-table:last-of-type tbody tr').forEach(row => {
                reportData.noodle.push({
                    code: row.cells[0].textContent,
                    nameCN: row.cells[1].textContent,
                    nameEN: row.cells[2].textContent,
                    spec: row.cells[3].textContent,
                    unit: row.cells[4].textContent,
                    stock: row.cells[5].querySelector('input').value,
                    in: row.cells[6].querySelector('input').value,
                    out: row.cells[7].querySelector('input').value,
                    remark: row.cells[8].querySelector('input').value
                });
            });
            
            // 保存到本地存储
            const allReports = JSON.parse(localStorage.getItem('allInventoryReports')) || {};
            allReports[selectedDate] = reportData;
            localStorage.setItem('allInventoryReports', JSON.stringify(allReports));
            
            alert(数据已保存（${selectedDate}）！);
            loadHistory();
        }
        
        // 加载历史记录
        function loadHistory() {
            const historyList = document.getElementById('historyList');
            const allReports = JSON.parse(localStorage.getItem('allInventoryReports')) || {};
            
            if (Object.keys(allReports).length === 0) {
                historyList.innerHTML = '<div style="padding:20px;text-align:center;color:#888">暂无历史记录</div>';
                return;
            }
            
            historyList.innerHTML = Object.keys(allReports)
                .sort()
                .reverse()
                .map(date => {
                    const report = allReports[date];
                    const soupCount = report.soupBase.filter(item => item.in > 0 || item.out > 0).length;
                    const noodleCount = report.noodle.filter(item => item.in > 0 || item.out > 0).length;
                    
                    return `
                    <div class="history-item" data-date="${date}">
                        <div class="history-date">${date}</div>
                        <div class="history-preview">
                            <span>汤底类: ${soupCount}项</span>
                            <span>面类: ${noodleCount}项</span>
                            <span>总记录: ${soupCount + noodleCount}项</span>
                        </div>
                    </div>
                    `;
                })
                .join('');
            
            // 添加点击事件
            document.querySelectorAll('.history-item').forEach(item => {
                item.addEventListener('click', function() {
                    const date = this.dataset.date;
                    viewHistory(date);
                    
                    // 高亮选中项
                    document.querySelectorAll('.history-item').forEach(i => {
                        i.classList.remove('active');
                    });
                    this.classList.add('active');
                });
            });
        }
        
        // 查看历史记录详情
        function viewHistory(date) {
            const allReports = JSON.parse(localStorage.getItem('allInventoryReports')) || {};
            const report = allReports[date];
            
            if (!report) {
                alert('找不到该日期的记录！');
                return;
            }
            
            // 设置面板标题
            document.getElementById('viewTitle').textContent = 记录详情 - ${date};
            
            // 生成报告内容
            let contentHTML = '';
            
            // 汤底类报告
            if (report.soupBase && report.soupBase.length > 0) {
                contentHTML += `
                <div class="category-title">汤底类 | SOUP BASE</div>
                <table class="report-table">
                    <thead>
                        <tr>
                            <th>编号</th>
                            <th>名称</th>
                            <th>入库</th>
                            <th>出库</th>
                            <th>备注</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${report.soupBase.map(item => `
                        <tr>
                            <td>${item.code}</td>
                            <td>${item.nameCN}</td>
                            <td>${item.in}</td>
                            <td>${item.out}</td>
                            <td>${item.remark || '-'}</td>
                        </tr>
                        `).join('')}
                    </tbody>
                </table>
                `;
            }
            
            // 面类报告
            if (report.noodle && report.noodle.length > 0) {
                contentHTML += `
                <div class="category-title">面类 | NOODLE</div>
                <table class="report-table">
                    <thead>
                        <tr>
                            <th>编号</th>
                            <th>名称</th>
                            <th>入库</th>
                            <th>出库</th>
                            <th>备注</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${report.noodle.map(item => `
                        <tr>
                            <td>${item.code}</td>
                            <td>${item.nameCN}</td>
                            <td>${item.in}</td>
                            <td>${item.out}</td>
                            <td>${item.remark || '-'}</td>
                        </tr>
                        `).join('')}
                    </tbody>
                </table>
                `;
            }
            
            document.getElementById('viewContent').innerHTML = contentHTML;
            document.getElementById('viewPanel').style.display = 'block';
        }
        
        // 页面加载时自动加载历史记录
        loadHistory();
    </script>
</body>
</html>